/* eslint-env mocha */

"use strict";

const request = require("supertest");
const host = require("../helpers").host;

describe("long urls should work", function() {
	it("responds with a bundle containing the correct polyfills", function() {
		this.timeout(30000);
		return request(host)
			.get(
				"/v3/polyfill.min.js?rum=false&unknown=ignore&version=3.27.0&callback=Boolean&ua=unknownBrowser&features=Array.prototype.copyWithin%2CArray.prototype.values%2CArray.prototype.filter%2Cdocument.querySelector%2CObject.setPrototypeOf%2CWeakSet%2CDocument%2Cdocument.visibilityState%2CArray.prototype.some%2CDOMTokenList%2CWeakMap%2CHTMLCanvasElement.prototype.toBlob%2CElement.prototype.after%2Catob%2CArray.prototype.forEach%2Cconsole.profile%2Cconsole.dir%2CDocumentFragment.prototype.append%2CMath.sign%2CMath.log1p%2CMath.sinh%2CSymbol.unscopables%2CMath.hypot%2CNumber.isFinite%2Cconsole.timeline%2CMutationObserver%2CElement.prototype.append%2CSymbol.toPrimitive%2CIntersectionObserverEntry%2Cconsole.debug%2Cconsole.error%2CFunction.prototype.bind%2Cperformance.now%2CObject.getOwnPropertyDescriptor%2Cconsole.timelineEnd%2CSymbol.isConcatSpreadable%2CElement.prototype.closest%2Cconsole.group%2CDate.now%2CNode.prototype.contains%2CDate.prototype.toISOString%2CPromise.prototype.finally%2CMap%2CElement.prototype.placeholder%2CString.prototype.%40%40iterator%2CArray.prototype.indexOf%2CDocumentFragment.prototype.prepend%2Cconsole.info%2CCustomEvent%2Cconsole.groupCollapsed%2CNumber.isSafeInteger%2CSymbol.match%2CSymbol.iterator%2Clocation.origin%2CArray.prototype.keys%2CArray.prototype.contains%2Cdocument.head%2CObject.keys%2CsetImmediate%2CMath.cosh%2CJSON%2Cconsole.profileEnd%2CString.prototype.padStart%2CSymbol.toStringTag%2CArray.prototype.find%2CArray.prototype.entries%2C_Iterator%2CSymbol.split%2CURL%2CSymbol.species%2CSet%2CMath.atanh%2Cconsole.log%2Cconsole.timeStamp%2C_DOMTokenList%2CHTMLPictureElement%2Cconsole.time%2CObject.create%2CArray.prototype.%40%40iterator%2CArray.prototype.includes%2CArray.of%2CObject.is%2CXMLHttpRequest%2C_TypedArray%2CNumber.parseInt%2CString.prototype.padEnd%2Cconsole.trace%2CWindow%2Cconsole.exception%2CEvent.focusin%2Cconsole.clear%2CNumber.parseFloat%2Cdocument.getElementsByClassName%2CString.prototype.codePointAt%2CWebAnimations%2CMath.trunc%2CgetComputedStyle%2CObject.defineProperties%2CDOMTokenList.prototype.%40%40iterator%2CElement.prototype.replaceWith%2CObject.freeze%2Cconsole.markTimeline%2CmatchMedia%2CElement.prototype.classList%2CAudioContext%2ClocalStorage%2CEvent%2CFunction.name%2C~viewport%2CString.prototype.startsWith%2CString.fromCodePoint%2CNumber.MIN_SAFE_INTEGER%2CArray.from%2CObject.defineProperty%2CElement.prototype.prepend%2CArray.prototype.findIndex%2CSymbol%2CMath.log10%2CSymbol.search%2C~html5-elements%2CSymbol.replace%2CObject.assign%2CElement.prototype.matches%2Cconsole.groupEnd%2CdevicePixelRatio%2CArray.prototype.map%2CArray.prototype.every%2Cnavigator.sendBeacon%2CMath.clz32%2CArray.isArray%2CHTMLDocument%2Cfetch%2CElement.prototype.dataset%2CElement.prototype.remove%2Cnavigator.geolocation%2CSymbol.hasInstance%2CNumber.isInteger%2CNumber.MAX_SAFE_INTEGER%2CDocumentFragment%2CMath.imul%2CNodeList.prototype.%40%40iterator%2CObject.getPrototypeOf%2CMath.log2%2CNumber.isNaN%2CElement.prototype.cloneNode%2CEvent.hashchange%2CBlob%2CPromise%2CIntersectionObserver%2CrequestAnimationFrame%2CNodeList.prototype.forEach%2Cconsole.assert%2Cconsole.timeEnd%2CString.prototype.endsWith%2CString.prototype.trim%2CElement.prototype.before%2Cscreen.orientation%2Cconsole%2CEventSource%2CArray.prototype.fill%2C_StringIterator%2CArray.prototype.reduce%2CUserTiming%2CArray.prototype.reduceRight%2Cconsole.dirxml%2Cconsole.count%2CMath.acosh%2CString.prototype.contains%2CObject.entries%2CRegExp.prototype.flags%2CArray.prototype.lastIndexOf%2CObject.getOwnPropertyNames%2C_ArrayIterator%2Cconsole.table%2Cconsole.profiles%2Cconsole.warn%2CElement%2CMath.asin"
			)
			.expect(200);
	});
});
